<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loot Rush 3D</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      color: #fff;
      font-family: Arial, sans-serif;
    }
    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 1.2em;
      background: rgba(0,0,0,0.5);
      padding: 8px 12px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="ui">ðŸ’° Score: <span id="score">0</span></div>

  <script type="module">
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.module.js';

    // Scene setup
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x101010);

    const camera = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000);
    camera.position.set(0, 8, 12);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(innerWidth, innerHeight);
    document.body.appendChild(renderer.domElement);

    // Lighting
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(10, 10, 5);
    scene.add(light);
    scene.add(new THREE.AmbientLight(0x555555));

    // Floor
    const floor = new THREE.Mesh(
      new THREE.PlaneGeometry(50, 50),
      new THREE.MeshStandardMaterial({ color: 0x222222 })
    );
    floor.rotation.x = -Math.PI / 2;
    scene.add(floor);

    // Player
    const player = new THREE.Mesh(
      new THREE.BoxGeometry(1, 1, 1),
      new THREE.MeshStandardMaterial({ color: 0x00ffcc })
    );
    player.position.y = 0.5;
    scene.add(player);

    // Base
    const base = new THREE.Mesh(
      new THREE.CylinderGeometry(2, 2, 0.3, 32),
      new THREE.MeshStandardMaterial({ color: 0x3333ff, emissive: 0x0000ff })
    );
    base.position.set(0, 0.15, -15);
    scene.add(base);

    // Loot cubes
    const loot = [];
    for (let i = 0; i < 15; i++) {
      const cube = new THREE.Mesh(
        new THREE.BoxGeometry(0.7, 0.7, 0.7),
        new THREE.MeshStandardMaterial({ color: 0xff0077, emissive: 0x660022 })
      );
      cube.position.set((Math.random() - 0.5) * 30, 0.35, (Math.random() - 0.5) * 30);
      scene.add(cube);
      loot.push(cube);
    }

    // Movement
    const keys = {};
    document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
    document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

    // Game state
    let carriedLoot = 0;
    let score = 0;
    const scoreEl = document.getElementById('score');

    // Brainrot sounds (optional meme vibe)
    const sounds = [
      'https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg',
      'https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg',
      'https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg'
    ];
    function playRandomSound() {
      const audio = new Audio(sounds[Math.floor(Math.random() * sounds.length)]);
      audio.volume = 0.4;
      audio.play();
    }

    function movePlayer(delta) {
      const speed = 8 * delta;
      if (keys['w']) player.position.z -= speed;
      if (keys['s']) player.position.z += speed;
      if (keys['a']) player.position.x -= speed;
      if (keys['d']) player.position.x += speed;
      camera.position.x = player.position.x;
      camera.position.z = player.position.z + 12;
      camera.lookAt(player.position.x, player.position.y, player.position.z);
    }

    // Loot collection
    function checkLoot() {
      loot.forEach(cube => {
        if (cube.visible && player.position.distanceTo(cube.position) < 1) {
          cube.visible = false;
          carriedLoot++;
          playRandomSound();
          flashScreen();
        }
      });
    }

    // Base deposit
    function checkBase() {
      if (player.position.distanceTo(base.position) < 3 && carriedLoot > 0) {
        score += carriedLoot;
        carriedLoot = 0;
        scoreEl.textContent = score;
        flashScreen('#00ffcc');
        playRandomSound();
      }
    }

    // Brainrot visual effect
    const overlay = document.createElement('div');
    overlay.style.position = 'absolute';
    overlay.style.top = 0;
    overlay.style.left = 0;
    overlay.style.width = '100%';
    overlay.style.height = '100%';
    overlay.style.pointerEvents = 'none';
    overlay.style.background = 'transparent';
    document.body.appendChild(overlay);

    function flashScreen(color = '#ff0077') {
      overlay.style.background = color;
      overlay.style.opacity = 0.4;
      setTimeout(() => overlay.style.opacity = 0, 100);
    }

    // Animate
    const clock = new THREE.Clock();
    function animate() {
      const delta = clock.getDelta();
      movePlayer(delta);
      checkLoot();
      checkBase();

      // Spin loot cubes
      loot.forEach(cube => cube.rotation.y += delta * 2);

      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    animate();

    addEventListener('resize', () => {
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
    });
  </script>
</body>
</html>
